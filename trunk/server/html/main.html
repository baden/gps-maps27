<!doctype html>  

<!--html lang="en" manifest="gps-maps.manifest"-->
<html>

<head>
  <meta charset="utf-8">

  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame 
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>GPS наблюдение</title>
  <meta name="description" content="GPS logging">
  <meta name="author" content="Batrak Denis">

  <script src="http://code.jquery.com/jquery-1.7.min.js"></script>

  <script>
	(function(window, $){
		var document = window.document;

		var addLoadEvent = function(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function() {
					if (oldonload) {
						oldonload();
					}
					func();
				}
			}
		}
		var addAll = function() {
			console.log('Hello, world!!!');
			//var table = document.querySelector('table tr:first');
			//console.log('Table:', );
			var last = $('table')
			last.after('<tr><td>a</td><td>b</td></tr>');

			$('#btn_start').click(function(){
				var i;
				for(i=0; i<100; i++){
					//last.append('<tr><td>' + i + '</td><td>waining</td></tr>');
					$.getJSON('/api/test', function (data) {
						last.append('<tr><td>' + data.a + '</td><td>ok</td></tr>');
					});
					
				}
			});
		}
		if (document.body == null) return addLoadEvent(function() {addAll();}); 

	})(window, jQuery);
  </script>

</head>

<body>
	Main Page.
	<button id="btn_start">Start</button>
	<table>
		<tr><td>-</td><td>-</td></tr>
	</table>


</body>
</html>
